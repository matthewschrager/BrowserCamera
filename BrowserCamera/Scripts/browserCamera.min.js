var Camera=function(){function n(){if(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,window.URL)this.CreateObjectURL=window.URL.createObjectURL;else if(window.webkitURL)this.CreateObjectURL=window.webkitURL.createObjectURL;else if(window.mozURL)this.CreateObjectURL=window.mozURL.createObjectURL;else throw"No URL object found.";}return n.prototype.InitializeVideo=function(n){typeof n=="undefined"&&(n=null),this.Video=n!=null?n:document.createElement("video"),this.Video.autoplay=!0,this.OwnsVideoElement=n==null,this.OwnsVideoElement&&(this.Video.setAttribute("style","display: none"),document.getElementsByTagName("html")[0].appendChild(this.Video))},n.prototype.ReleaseVideo=function(){this.OwnsVideoElement&&this.Video.parentElement.removeChild(this.Video),this.Video=null,this.OwnsVideoElement=!1},n.prototype.InitializeCanvas=function(n){typeof n=="undefined"&&(n=null),this.Canvas=n!=null?n:document.createElement("canvas"),this.OwnsCanvasElement=n==null,this.OwnsCanvasElement&&(this.Canvas.setAttribute("style","display: none"),document.getElementsByTagName("html")[0].appendChild(this.Canvas))},n.prototype.ReleaseCanvas=function(){this.OwnsCanvasElement&&this.Canvas.parentElement.removeChild(this.Canvas),this.Canvas=null,this.OwnsCanvasElement=!1},n.prototype.Start=function(n,t){typeof t=="undefined"&&(t=null);var i=this;this.InitializeVideo(document.getElementById(t)),navigator.getUserMedia({video:!0},function(t){i.LocalMediaStream=t,i.Video.src=i.CreateObjectURL(i.LocalMediaStream),n&&n()},function(n){throw"Could not acquire device. Error: "+n;})},n.prototype.Stop=function(){this.Video&&(this.Video.pause(),this.Video.mozSrcObject?this.Video.mozSrcObject=null:this.Video.src=window.webkitURL?"":null),this.LocalMediaStream&&this.LocalMediaStream.stop(),this.ReleaseVideo()},n.prototype.IsStarted=function(){return this.Video!=null&&this.Video!=undefined},n.prototype.TakeSnapshot=function(n,t){typeof t=="undefined"&&(t=null);var i=this;if(!this.Video)throw"The camera must be started to take a snapshot. Call Start() before TakeSnapshot().";this.InitializeCanvas(document.getElementById(t)),setTimeout(function(){i.Canvas.width=i.Video.videoWidth,i.Canvas.height=i.Video.videoHeight,i.Canvas.getContext("2d").drawImage(i.Video,0,0);var t=i.Canvas.toDataURL("image/png");i.ReleaseCanvas(),n&&n(t)},50)},n.prototype.PostImageData=function(n,t,i,r){var u=i.replace("data:image/png;base64,",""),f='{ "'+t+'": "'+u+'" }';$.ajax({url:n,type:"POST",data:f,contentType:"application/json"}).done(function(n){return r(n)})},n.prototype.PostSnapshot=function(n,t,i){var r=this;this.TakeSnapshot(function(u){return r.PostImageData(n,t,u,i)})},n}(),CameraStatic=function(){function n(){}return n.prototype.Create=function(){return new Camera},n}(),BrowserCam=new CameraStatic